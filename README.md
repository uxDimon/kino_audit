# Аудит

С перформенсом всё хорошо, бест практик тоже всё хорошо. Единственное на что жалуется это метрики от Гугла, Яндекса, Фейсбука и т.д. Единственное до чего могу докопаться это <picture> Больше проблем с перформенсом я не нашёл, если только есть какие то определённые проблемы в которые можно копать но это уже вам видней.

## picture

Самый большой косяк который вижу это велосипед с лейз лоудингом который реализован на js и подменяет src когда картинка загрузилась. Работает так себе и я заметил много косяков, на главной первая картинка долго грузится, также есть дубли загрузки одной и той же картинки в формате .webp и .jpg (тоже на главной) Возможно в нынешнем лейзи лодинге есть какой то скрытый смысл но я его не вижу.

Я бы рекомендовал использовать нативный `loading="lazy"` а для изображений которые в самом верху сайта `loading="eager"` что бы грузились сразу (хотя он работает по умолчанию, но так на всякий случай) Потому что нативный loading в любом случае будет работать лучше и надёжнее чем любая библиотека или собственное решение (ну если конечно у вас нет каких то специфических требований)

Для того что бы не было вертикального сдвига указывайте для всех изображений `width="640" height="360"`

```html
<picture>
	<source srcset="./test.webp" type="image/webp" />

	<img
		width="640"
		height="360"
		loading="lazy"
		decoding="async"
		src="./test.jpg"
		alt="DCEU's Justice League Is Getting Recast Entirely, According to New Report" />
</picture>
```

Можно ещё decoding="async" влепить но у вас нет больших изображений так что не думаю что сильно поможет

## Советы которые не факт что сильно помогут

На главной страници все изображения разного размера и в идеале загружать для них картинки в том же разрешении в каком они на сайте. А то все изображения загружаются с разрешением 640×360px но большинство из них в реальности меньше некоторые в двое, Lighthouse такое не любит.

Загрузку разного разрешения изображений можно тоже сделать нативно

```html
<picture>
	<source srcset="./test_s.webp 375w, ./test_m.webp 768w, ./test_l.webp 1000w" type="image/webp" />

	<img
		width="640"
		height="360"
		loading="lazy"
		decoding="async"
		src="./test.jpg"
		alt="DCEU's Justice League Is Getting Recast Entirely, According to New Report" />
</picture>
```

На экранах от 0 до 375 пикселей загрузится test_s.webp, от 375 до 768 пикселей загрузится test_m.webp, на всём что больше загрузится test_l.webp

---

### css

Вот это мне вообще не понятно зачем, стили привозить в документе а не отдельным файлом. Возможно, вы так пытаетесь не привозить лишние стили ну и на этом скорее всего при первой загрузки вы экономите от 2 до 5 килобайт, но только при первой! Но при переходи на другие страницы у вас с сервера приходит документ весом 30-37.5 килобайт из которых 65-70% это css, который нужно снова загрузить и ещё раз распарсить потому что браузер считает это новыми стилями. В принципе это было бы оправданно если общие стили приходили фалом а отдельные специфические были в документе, нооо всё равно сомнительная оптимизация))
Я бы порекомендовал просто привозить 1 файл со стилями и не придумывать очередной велосипед)

---

### Изображения для экранов с большой плотностью пикселей

Не знаю на сколько вам это нужно, но пользовательский опыт может улучшить. Пользователям на макбуках было бы приятно не разглядывать мыльные картинки, ибо у них от 2x плотность пикселей. Про мобилки я молчу там от 3x плотность.

```html
<picture>
	<source srcset="./test.webp, ./test@2x.webp 2x" media="(min-width: 600px)" type="image/webp" />
	<source srcset="./test_m.webp, ./test_m@2x.webp 2x" type="image/webp" />

	<source srcset="./test.jpg, ./test@2x.jpg 2x" media="(min-width: 600px)" type="image/jpeg" />
	<source srcset="./test_m.jpg, ./test_m@2x.jpg 2x" type="image/jpeg" />

	<img
		width="640"
		height="360"
		loading="eager"
		decoding="sync"
		src="./test.jpg"
		alt="DCEU's Justice League Is Getting Recast Entirely, According to New Report" />
</picture>
```

> Но да все эти увы с требуют генерации дополнительных изображений, так что сами решайте будет это оправдано али нет
